<!DOCTYPE html>
<html lang="pt" xmlns:th="http://www.thymeleaf.org">
    <th:block th:insert="~{layout :: head('My Orders', ~{::pageStyles})}"></th:block>

    <th:block th:replace="~{layout :: layout(~{::content}, ~{::pageScripts})}">
        <main th:fragment="content" class="w-full">
            <section class="w-full py-12 px-6">
                <div class="max-w-6xl mx-auto space-y-8">
                    <!-- Header -->
                    <div class="text-center space-y-3">
                        <div class="inline-block px-3 py-1 rounded-full text-xs font-medium" 
                             style="background-color: #73E5E2; color: #394F87;">
                            ðŸ“¦ Orders
                        </div>
                        <h1 class="text-4xl font-bold" style="color: #394F87;">My Orders</h1>
                        <p class="text-sm" style="color: #394F87; opacity: 0.7;">Track and view your order history</p>
                    </div>

                    <!-- Empty Orders Message -->
                    <div th:if="${orders == null || orders.isEmpty()}" 
                         class="text-center py-16 space-y-6">
                        <div class="inline-flex items-center justify-center w-24 h-24 rounded-full" 
                             style="background-color: rgba(115, 229, 226, 0.2);">
                            <span class="text-5xl">ðŸ“¦</span>
                        </div>
                        
                        <div class="space-y-3">
                            <h2 class="text-2xl font-bold" style="color: #394F87;">No orders yet</h2>
                            <p class="text-sm max-w-md mx-auto" style="color: #394F87; opacity: 0.7;">
                                You haven't placed any orders yet. Start shopping to see your orders here!
                            </p>
                        </div>

                        <a th:href="@{/product/all-products}" 
                           class="inline-block px-6 py-3 rounded-lg text-sm font-medium text-white transition-all hover:opacity-90"
                           style="background-color: #fabb4d;">
                            Browse Products
                        </a>
                    </div>

                    <!-- Orders List -->
                    <div th:if="${orders != null && !orders.isEmpty()}" 
                         class="space-y-4">
                        <div th:each="order : ${orders}" 
                             class="rounded-xl p-6 transition-all" 
                             style="background-color: white; border: 1px solid rgba(57, 79, 135, 0.1);">
                            <!-- Order Header -->
                            <div class="flex items-start justify-between mb-4 pb-4" 
                                 style="border-bottom: 1px solid rgba(57, 79, 135, 0.1);">
                                <div class="space-y-1">
                                    <h3 class="font-semibold" style="color: #394F87;">
                                        Order #<span th:text="${#strings.substring(order.orderId.toString(), 0, 8)}"></span>
                                    </h3>
                                    <p class="text-xs" style="color: #394F87; opacity: 0.6;">
                                        <span th:text="${#temporals.format(order.orderDate, 'MMM dd, yyyy HH:mm')}"></span>
                                    </p>
                                </div>
                                
                                <div class="flex items-center gap-3">
                                    <span class="px-3 py-1 rounded-full text-xs font-medium"
                                          th:classappend="${order.status.name() == 'DELIVERED' ? 'delivered-badge' : 
                                                          order.status.name() == 'SHIPPED' ? 'shipped-badge' : 
                                                          order.status.name() == 'PROCESSING' ? 'processing-badge' : 
                                                          order.status.name() == 'CANCELLED' ? 'cancelled-badge' : 
                                                          'pending-badge'}"
                                          th:text="${order.status.status}">
                                    </span>
                                    <span class="text-lg font-bold" style="color: #fabb4d;" 
                                          th:text="'$'+${order.totalAmount}"></span>
                                </div>
                            </div>

                            <!-- Order Items -->
                            <div class="space-y-3">
                                <div th:each="item : ${order.orderItems}" 
                                     class="flex items-center gap-4">
                                    <!-- Product Image -->
                                    <th:block th:if="${item.product.productImages != null and !item.product.productImages.isEmpty()}">
                                        <div class="w-16 h-16 rounded-lg overflow-hidden flex-shrink-0" 
                                             style="background-color: #f8f9fa;">
                                            <img th:src="@{|/uploads/${item.product.productImages[0].productImageId}${item.product.productImages[0].fileExtension}|}"
                                                 alt="Product Image"
                                                 class="w-full h-full object-cover">
                                        </div>
                                    </th:block>
                                    <th:block th:unless="${item.product.productImages != null and !item.product.productImages.isEmpty()}">
                                        <div class="w-16 h-16 rounded-lg overflow-hidden flex-shrink-0" 
                                             style="background-color: #f8f9fa;">
                                            <img th:src="@{/img/petshop-logo.svg}"
                                                 alt="No image"
                                                 class="w-full h-full object-cover">
                                        </div>
                                    </th:block>

                                    <!-- Product Info -->
                                    <div class="flex-1">
                                        <h4 class="text-sm font-medium" style="color: #394F87;" th:text="${item.product.name}"></h4>
                                        <p class="text-xs" style="color: #394F87; opacity: 0.6;">
                                            Qty: <span th:text="${item.quantity}"></span> Ã— 
                                            <span th:text="'$'+${item.unitPrice}"></span>
                                        </p>
                                    </div>

                                    <div class="text-right">
                                        <span class="text-sm font-bold" style="color: #394F87;" 
                                              th:text="'$'+${item.totalPrice}"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <th:block th:fragment="pageStyles">
            <style>
                .pending-badge {
                    background-color: rgba(251, 220, 142, 0.2);
                    color: #fabb4d;
                }
                .processing-badge {
                    background-color: rgba(57, 79, 135, 0.1);
                    color: #394F87;
                }
                .shipped-badge {
                    background-color: rgba(115, 229, 226, 0.2);
                    color: #73E5E2;
                }
                .delivered-badge {
                    background-color: rgba(34, 197, 94, 0.1);
                    color: #22c55e;
                }
                .cancelled-badge {
                    background-color: rgba(239, 68, 68, 0.1);
                    color: #ef4444;
                }
            </style>
        </th:block>
    </th:block>
</html>
